<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GUARDIAN | Advanced Solana Security Platform</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect fill='%2306b6d4' rx='20' width='100' height='100'/><path fill='white' d='M50 20L70 45H55V80H45V45H30L50 20Z'/></svg>">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'sans-serif'], mono: ['JetBrains Mono', 'monospace'] }
                }
            }
        }
    </script>
    <style>
        body { background: linear-gradient(135deg, #020617 0%, #0a1628 100%); }
        .glass { background: rgba(15, 23, 42, 0.7); backdrop-filter: blur(20px); }
        .card {
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(51, 65, 85, 0.4);
            border-radius: 12px;
            backdrop-filter: blur(10px);
        }
        .card-hover:hover { border-color: rgba(6, 182, 212, 0.6); transform: translateY(-2px); transition: all 0.3s ease; }
        .btn-primary { background: linear-gradient(135deg, #06b6d4, #0891b2); transition: all 0.3s ease; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 10px 25px rgba(6, 182, 212, 0.3); }
        .badge { padding: 0.25rem 0.75rem; border-radius: 9999px; font-size: 0.75rem; font-weight: 600; }
        .badge-critical { background: rgba(239, 68, 68, 0.2); color: #ef4444; }
        .badge-high { background: rgba(249, 115, 22, 0.2); color: #f97316; }
        .badge-medium { background: rgba(234, 179, 8, 0.2); color: #eab308; }
        .badge-low { background: rgba(34, 197, 94, 0.2); color: #22c55e; }
    </style>
</head>
<body class="text-slate-100" x-data="app()" x-init="init()">
    <header class="glass border-b border-slate-800/50 sticky top-0 z-50">
        <div class="max-w-screen-2xl mx-auto px-6 h-16 flex items-center justify-between">
            <div class="flex items-center gap-4">
                <div class="w-10 h-10 rounded-lg bg-gradient-to-br from-cyan-500 to-purple-600 flex items-center justify-center">
                    <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/></svg>
                </div>
                <div><h1 class="font-bold text-xl">GUARDIAN</h1><p class="text-xs text-slate-400">Solana Security</p></div>
            </div>
            <nav class="flex gap-2 glass rounded-xl p-1.5">
                <button @click="tab='overview'" :class="tab==='overview'?'bg-cyan-500 text-white':'text-slate-400'" class="px-4 py-2 rounded-lg text-sm font-semibold">Dashboard</button>
                <button @click="tab='threats'" :class="tab==='threats'?'bg-cyan-500 text-white':'text-slate-400'" class="px-4 py-2 rounded-lg text-sm font-semibold">Threats</button>
                <button @click="tab='scanner'" :class="tab==='scanner'?'bg-cyan-500 text-white':'text-slate-400'" class="px-4 py-2 rounded-lg text-sm font-semibold">Scanner</button>
            </nav>
            <div class="flex items-center gap-2 glass px-3 py-1.5 rounded-lg">
                <div class="w-2 h-2 rounded-full" :class="connected?'bg-green-500 animate-pulse':'bg-red-500'"></div>
                <span class="text-xs" x-text="connected?'Online':'Offline'"></span>
            </div>
        </div>
    </header>
    <main class="max-w-screen-2xl mx-auto px-6 py-8">
        <div x-show="tab==='overview'" class="space-y-6">
            <div class="grid grid-cols-4 gap-6">
                <div class="card p-6"><div class="text-xs text-slate-400 mb-2">Active Threats</div><div class="text-3xl font-bold text-red-500" x-text="stats.threats?.active||0"></div></div>
                <div class="card p-6"><div class="text-xs text-slate-400 mb-2">Resolved</div><div class="text-3xl font-bold text-green-500" x-text="stats.threats?.resolved||0"></div></div>
                <div class="card p-6"><div class="text-xs text-slate-400 mb-2">Agents</div><div class="text-3xl font-bold text-cyan-500">16</div></div>
                <div class="card p-6"><div class="text-xs text-slate-400 mb-2">Risk Index</div><div class="text-3xl font-bold text-yellow-500" x-text="riskIndex"></div></div>
            </div>
        </div>
        <div x-show="tab==='threats'" class="card p-6">
            <h2 class="text-xl font-bold mb-4">Recent Threats</h2>
            <div class="space-y-2">
                <template x-for="threat in threats.slice(0,10)" :key="threat.id">
                    <div class="p-4 glass rounded-lg flex justify-between">
                        <div><div class="font-medium" x-text="threat.threat_type"></div><div class="text-xs text-slate-400" x-text="threat.detected_by"></div></div>
                        <span :class="getSeverityBadge(threat.severity)" x-text="threat.severity.toFixed(0)"></span>
                    </div>
                </template>
            </div>
        </div>
        <div x-show="tab==='scanner'" class="card p-6">
            <h2 class="text-xl font-bold mb-4">Quick Scanner</h2>
            <input x-model="scanInput" type="text" placeholder="Enter address..." class="w-full px-4 py-3 bg-slate-900 border border-slate-700 rounded-lg mb-4">
            <button @click="quickScan()" class="btn-primary text-white px-6 py-3 rounded-lg font-semibold w-full">Scan</button>
            <div x-show="scanResult" class="mt-4 p-4 glass rounded-lg text-center">
                <div class="text-4xl font-bold" :class="getSeverityClass(scanResult?.risk_score)" x-text="scanResult?.risk_score?.toFixed(1)"></div>
                <div class="text-sm text-slate-400 mt-2">Risk Score</div>
            </div>
        </div>
    </main>
    <script>
    function app(){return{tab:'overview',connected:false,stats:{},threats:[],scanInput:'',scanResult:null,scanning:false,get riskIndex(){return Math.min(100,Math.round(((this.stats.threats?.active||0)*2)+((this.stats.threats?.avg_severity||0)*0.5)))},async init(){await Promise.all([this.loadStats(),this.loadThreats()]);this.connectWS();setInterval(()=>this.loadStats(),15000)},connectWS(){try{const ws=new WebSocket(`ws://${location.host}/ws`);ws.onopen=()=>this.connected=true;ws.onclose=()=>{this.connected=false;setTimeout(()=>this.connectWS(),5000)}}catch(e){}},async loadStats(){try{const r=await fetch('/api/status');if(r.ok){this.stats=await r.json();this.connected=true}}catch(e){}},async loadThreats(){try{const r=await fetch('/api/threats?limit=50');if(r.ok){const data=await r.json();this.threats=data.threats||[]}}catch(e){}},async quickScan(){if(!this.scanInput)return;this.scanning=true;this.scanResult=null;try{const r=await fetch('/api/score',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({address:this.scanInput})});if(r.ok)this.scanResult=await r.json()}catch(e){}this.scanning=false},getSeverityClass(s){if(!s&&s!==0)return'text-slate-500';return s>=70?'text-red-500':s>=50?'text-orange-500':s>=30?'text-yellow-500':'text-green-500'},getSeverityBadge(s){if(!s&&s!==0)return'badge badge-low';return s>=70?'badge badge-critical':s>=50?'badge badge-high':s>=30?'badge badge-medium':'badge badge-low'}}}
    </script>
</body>
</html>